
// This code conforms with the UFCx specification version 2018.2.0.dev0
// and was automatically generated by FFCx version 0.11.0.dev0.
//
// This code was generated with the following options:
//
//  {'dir': '.',
//   'epsilon': 1e-14,
//   'language': 'C',
//   'part': 'full',
//   'profile': False,
//   'scalar_type': 'float64',
//   'sum_factorization': False,
//   'table_atol': 1e-09,
//   'table_rtol': 1e-06,
//   'ufl_file': ['/work/poisson_demo/poisson.py'],
//   'verbosity': 30,
//   'visualise': False}

#include <math.h>
#include <stdalign.h>
#include <stdlib.h>
#include <string.h>
#include <ufcx.h>



// Code for integral integral_ff93261e93c78722c80bf2dcbc415a89a8ada6c6_triangle

void tabulate_tensor_integral_ff93261e93c78722c80bf2dcbc415a89a8ada6c6_triangle(double* restrict A,
                                    const double* restrict w,
                                    const double* restrict c,
                                    const double* restrict coordinate_dofs,
                                    const int* restrict entity_local_index,
                                    const uint8_t* restrict quadrature_permutation,
                                    void* custom_data)
{
// Quadrature rules
static const double weights_083[1] = {0.5};
// Precomputed values of basis functions and precomputations
// FE* dimensions: [permutation][entities][points][dofs]
static const double FE0_C0_D01_Q083[1][1][1][3] = {{{{-1.0, 0.0, 1.0}}}};
static const double FE1_C0_D10_Q083[1][1][1][3] = {{{{-1.0, 1.0, 0.0}}}};
// ------------------------ 
// Section: Jacobian
// Inputs: FE0_C0_D01_Q083, FE1_C0_D10_Q083, coordinate_dofs
// Outputs: J0_c3, J0_c1, J0_c0, J0_c2
double J0_c0 = 0.0;
double J0_c3 = 0.0;
double J0_c1 = 0.0;
double J0_c2 = 0.0;
{
  for (int ic = 0; ic < 3; ++ic)
  {
    J0_c0 += coordinate_dofs[(ic) * 3] * FE1_C0_D10_Q083[0][0][0][ic];
    J0_c3 += coordinate_dofs[(ic) * 3 + 1] * FE0_C0_D01_Q083[0][0][0][ic];
    J0_c1 += coordinate_dofs[(ic) * 3] * FE0_C0_D01_Q083[0][0][0][ic];
    J0_c2 += coordinate_dofs[(ic) * 3 + 1] * FE1_C0_D10_Q083[0][0][0][ic];
  }
}
// ------------------------ 
double sp_083_0 = J0_c0 * J0_c3;
double sp_083_1 = J0_c1 * J0_c2;
double sp_083_2 = -sp_083_1;
double sp_083_3 = sp_083_0 + sp_083_2;
double sp_083_4 = J0_c0 / sp_083_3;
double sp_083_5 = -J0_c1;
double sp_083_6 = sp_083_5 / sp_083_3;
double sp_083_7 = sp_083_4 * sp_083_4;
double sp_083_8 = sp_083_4 * sp_083_6;
double sp_083_9 = sp_083_6 * sp_083_6;
double sp_083_10 = J0_c3 / sp_083_3;
double sp_083_11 = -J0_c2;
double sp_083_12 = sp_083_11 / sp_083_3;
double sp_083_13 = sp_083_12 * sp_083_12;
double sp_083_14 = sp_083_10 * sp_083_12;
double sp_083_15 = sp_083_10 * sp_083_10;
double sp_083_16 = sp_083_7 + sp_083_13;
double sp_083_17 = sp_083_8 + sp_083_14;
double sp_083_18 = sp_083_15 + sp_083_9;
double sp_083_19 = c[0] * sp_083_16;
double sp_083_20 = c[0] * sp_083_17;
double sp_083_21 = c[0] * sp_083_18;
double sp_083_22 = fabs(sp_083_3);
double sp_083_23 = sp_083_19 * sp_083_22;
double sp_083_24 = sp_083_20 * sp_083_22;
double sp_083_25 = sp_083_21 * sp_083_22;
for (int iq = 0; iq < 1; ++iq)
{
  // ------------------------ 
  // Section: Intermediates
  // Inputs: 
  // Outputs: fw0, fw1, fw2
  double fw0 = 0;
  double fw1 = 0;
  double fw2 = 0;
  {
    fw0 = sp_083_25 * weights_083[iq];
    fw1 = sp_083_24 * weights_083[iq];
    fw2 = sp_083_23 * weights_083[iq];
  }
  // ------------------------ 
  // ------------------------ 
  // Section: Tensor Computation
  // Inputs: fw1, FE1_C0_D10_Q083, fw2, fw0, FE0_C0_D01_Q083
  // Outputs: A
  {
    double temp_0[3] = {0};
    for (int j = 0; j < 3; ++j)
    {
      temp_0[j] = fw0 * FE1_C0_D10_Q083[0][0][0][j];
    }
    double temp_1[3] = {0};
    for (int j = 0; j < 3; ++j)
    {
      temp_1[j] = fw1 * FE0_C0_D01_Q083[0][0][0][j];
    }
    double temp_2[3] = {0};
    for (int j = 0; j < 3; ++j)
    {
      temp_2[j] = fw1 * FE1_C0_D10_Q083[0][0][0][j];
    }
    double temp_3[3] = {0};
    for (int j = 0; j < 3; ++j)
    {
      temp_3[j] = fw2 * FE0_C0_D01_Q083[0][0][0][j];
    }
    for (int j = 0; j < 3; ++j)
    {
      for (int i = 0; i < 3; ++i)
      {
        A[3 * (i) + (j)] += FE1_C0_D10_Q083[0][0][0][i] * temp_0[j];
        A[3 * (i) + (j)] += FE1_C0_D10_Q083[0][0][0][i] * temp_1[j];
        A[3 * (i) + (j)] += FE0_C0_D01_Q083[0][0][0][i] * temp_2[j];
        A[3 * (i) + (j)] += FE0_C0_D01_Q083[0][0][0][i] * temp_3[j];
      }
    }
  }
  // ------------------------ 
}

}



ufcx_integral integral_ff93261e93c78722c80bf2dcbc415a89a8ada6c6_triangle =
{
  .enabled_coefficients = NULL,
  .tabulate_tensor_float32 = NULL,
  .tabulate_tensor_float64 = tabulate_tensor_integral_ff93261e93c78722c80bf2dcbc415a89a8ada6c6_triangle,
  .tabulate_tensor_complex64 = NULL,
  .tabulate_tensor_complex128 = NULL,
  .needs_facet_permutations = false,
  .coordinate_element_hash = UINT64_C(16933917890882727400),
  .domain = 2,
};

// End of code for integral integral_ff93261e93c78722c80bf2dcbc415a89a8ada6c6_triangle

// Code for integral integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle

void tabulate_tensor_integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle(double* restrict A,
                                    const double* restrict w,
                                    const double* restrict c,
                                    const double* restrict coordinate_dofs,
                                    const int* restrict entity_local_index,
                                    const uint8_t* restrict quadrature_permutation,
                                    void* custom_data)
{
// Quadrature rules
static const double weights_48e[3] = {0.1666666666666667, 0.1666666666666667, 0.1666666666666667};
// Precomputed values of basis functions and precomputations
// FE* dimensions: [permutation][entities][points][dofs]
static const double FE0_C0_Q48e[1][1][3][3] = {{{{0.6666666666666667, 0.1666666666666667, 0.1666666666666666},
  {0.1666666666666667, 0.1666666666666666, 0.6666666666666666},
  {0.1666666666666668, 0.6666666666666666, 0.1666666666666666}}}};
static const double FE1_C0_D10_Q48e[1][1][1][3] = {{{{-1.0, 1.0, 0.0}}}};
static const double FE1_C1_D01_Q48e[1][1][1][3] = {{{{-1.0, 0.0, 1.0}}}};
// ------------------------ 
// Section: Jacobian
// Inputs: FE1_C0_D10_Q48e, coordinate_dofs, FE1_C1_D01_Q48e
// Outputs: J0_c3, J0_c1, J0_c0, J0_c2
double J0_c0 = 0.0;
double J0_c3 = 0.0;
double J0_c1 = 0.0;
double J0_c2 = 0.0;
{
  for (int ic = 0; ic < 3; ++ic)
  {
    J0_c0 += coordinate_dofs[(ic) * 3] * FE1_C0_D10_Q48e[0][0][0][ic];
    J0_c3 += coordinate_dofs[(ic) * 3 + 1] * FE1_C1_D01_Q48e[0][0][0][ic];
    J0_c1 += coordinate_dofs[(ic) * 3] * FE1_C1_D01_Q48e[0][0][0][ic];
    J0_c2 += coordinate_dofs[(ic) * 3 + 1] * FE1_C0_D10_Q48e[0][0][0][ic];
  }
}
// ------------------------ 
double sp_48e_0 = J0_c0 * J0_c3;
double sp_48e_1 = J0_c1 * J0_c2;
double sp_48e_2 = -sp_48e_1;
double sp_48e_3 = sp_48e_0 + sp_48e_2;
double sp_48e_4 = fabs(sp_48e_3);
for (int iq = 0; iq < 3; ++iq)
{
  // ------------------------ 
  // Section: Coefficient
  // Inputs: FE0_C0_Q48e, w
  // Outputs: w0
  double w0 = 0.0;
  {
    for (int ic = 0; ic < 3; ++ic)
    {
      w0 += w[ic] * FE0_C0_Q48e[0][0][iq][ic];
    }
  }
  // ------------------------ 
  // ------------------------ 
  // Section: Intermediates
  // Inputs: w0
  // Outputs: fw0
  double fw0 = 0;
  {
    double sv_48e_0 = sp_48e_4 * w0;
    fw0 = sv_48e_0 * weights_48e[iq];
  }
  // ------------------------ 
  // ------------------------ 
  // Section: Tensor Computation
  // Inputs: fw0, FE0_C0_Q48e
  // Outputs: A
  {
    for (int i = 0; i < 3; ++i)
    {
      A[(i)] += fw0 * FE0_C0_Q48e[0][0][iq][i];
    }
  }
  // ------------------------ 
}

}

bool enabled_coefficients_integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle[2] = {1, 0};

ufcx_integral integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle =
{
  .enabled_coefficients = enabled_coefficients_integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle,
  .tabulate_tensor_float32 = NULL,
  .tabulate_tensor_float64 = tabulate_tensor_integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle,
  .tabulate_tensor_complex64 = NULL,
  .tabulate_tensor_complex128 = NULL,
  .needs_facet_permutations = false,
  .coordinate_element_hash = UINT64_C(16933917890882727400),
  .domain = 2,
};

// End of code for integral integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle

// Code for integral integral_28e05512f71e9adaab994a9addc20b831e88d426_interval

void tabulate_tensor_integral_28e05512f71e9adaab994a9addc20b831e88d426_interval(double* restrict A,
                                    const double* restrict w,
                                    const double* restrict c,
                                    const double* restrict coordinate_dofs,
                                    const int* restrict entity_local_index,
                                    const uint8_t* restrict quadrature_permutation,
                                    void* custom_data)
{
// Quadrature rules
static const double weights_4a8[2] = {0.5, 0.5};
// Precomputed values of basis functions and precomputations
// FE* dimensions: [permutation][entities][points][dofs]
static const double FE0_C0_F_Q4a8[1][3][2][3] = {{{{0.0, 0.7886751345948129, 0.2113248654051871},
  {0.0, 0.2113248654051871, 0.7886751345948129}},
  {{0.7886751345948129, 0.0, 0.2113248654051872},
  {0.2113248654051871, 0.0, 0.7886751345948129}},
  {{0.788675134594813, 0.2113248654051871, 0.0},
  {0.2113248654051873, 0.7886751345948129, 0.0}}}};
static const double FE1_C0_D01_F_Q4a8[1][1][1][3] = {{{{-1.0, 0.0, 1.0}}}};
static const double FE1_C0_D10_F_Q4a8[1][1][1][3] = {{{{-1.0, 1.0, 0.0}}}};
static const double triangle_cell_facet_jacobian[3][2][1] = {{{-1.0},
  {1.0}},
  {{0.0},
  {1.0}},
  {{1.0},
  {0.0}}};
// ------------------------ 
// Section: Jacobian
// Inputs: coordinate_dofs, FE1_C0_D10_F_Q4a8, FE1_C0_D01_F_Q4a8
// Outputs: J0_c3, J0_c1, J0_c0, J0_c2
double J0_c0 = 0.0;
double J0_c1 = 0.0;
double J0_c2 = 0.0;
double J0_c3 = 0.0;
{
  for (int ic = 0; ic < 3; ++ic)
  {
    J0_c0 += coordinate_dofs[(ic) * 3] * FE1_C0_D10_F_Q4a8[0][0][0][ic];
    J0_c1 += coordinate_dofs[(ic) * 3] * FE1_C0_D01_F_Q4a8[0][0][0][ic];
    J0_c2 += coordinate_dofs[(ic) * 3 + 1] * FE1_C0_D10_F_Q4a8[0][0][0][ic];
    J0_c3 += coordinate_dofs[(ic) * 3 + 1] * FE1_C0_D01_F_Q4a8[0][0][0][ic];
  }
}
// ------------------------ 
double sp_4a8_0 = J0_c0 * triangle_cell_facet_jacobian[entity_local_index[0]][0][0];
double sp_4a8_1 = J0_c1 * triangle_cell_facet_jacobian[entity_local_index[0]][1][0];
double sp_4a8_2 = sp_4a8_0 + sp_4a8_1;
double sp_4a8_3 = sp_4a8_2 * sp_4a8_2;
double sp_4a8_4 = triangle_cell_facet_jacobian[entity_local_index[0]][0][0] * J0_c2;
double sp_4a8_5 = triangle_cell_facet_jacobian[entity_local_index[0]][1][0] * J0_c3;
double sp_4a8_6 = sp_4a8_4 + sp_4a8_5;
double sp_4a8_7 = sp_4a8_6 * sp_4a8_6;
double sp_4a8_8 = sp_4a8_3 + sp_4a8_7;
double sp_4a8_9 = sqrt(sp_4a8_8);
for (int iq = 0; iq < 2; ++iq)
{
  // ------------------------ 
  // Section: Coefficient
  // Inputs: w, FE0_C0_F_Q4a8
  // Outputs: w1
  double w1 = 0.0;
  {
    for (int ic = 0; ic < 3; ++ic)
    {
      w1 += w[3 + (ic)] * FE0_C0_F_Q4a8[0][entity_local_index[0]][iq][ic];
    }
  }
  // ------------------------ 
  // ------------------------ 
  // Section: Intermediates
  // Inputs: w1
  // Outputs: fw0
  double fw0 = 0;
  {
    double sv_4a8_0 = sp_4a8_9 * w1;
    fw0 = sv_4a8_0 * weights_4a8[iq];
  }
  // ------------------------ 
  // ------------------------ 
  // Section: Tensor Computation
  // Inputs: fw0, FE0_C0_F_Q4a8
  // Outputs: A
  {
    for (int i = 0; i < 3; ++i)
    {
      A[(i)] += fw0 * FE0_C0_F_Q4a8[0][entity_local_index[0]][iq][i];
    }
  }
  // ------------------------ 
}

}

bool enabled_coefficients_integral_28e05512f71e9adaab994a9addc20b831e88d426_interval[2] = {0, 1};

ufcx_integral integral_28e05512f71e9adaab994a9addc20b831e88d426_interval =
{
  .enabled_coefficients = enabled_coefficients_integral_28e05512f71e9adaab994a9addc20b831e88d426_interval,
  .tabulate_tensor_float32 = NULL,
  .tabulate_tensor_float64 = tabulate_tensor_integral_28e05512f71e9adaab994a9addc20b831e88d426_interval,
  .tabulate_tensor_complex64 = NULL,
  .tabulate_tensor_complex128 = NULL,
  .needs_facet_permutations = false,
  .coordinate_element_hash = UINT64_C(16933917890882727400),
  .domain = 1,
};

// End of code for integral integral_28e05512f71e9adaab994a9addc20b831e88d426_interval

// Code for form form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd


uint64_t finite_element_hashes_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[2] = {UINT64_C(16933917890882727400), UINT64_C(16933917890882727400)};
int form_integral_offsets_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[6] = {0, 1, 1, 1, 1, 1};
static ufcx_integral* form_integrals_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[1] = {&integral_ff93261e93c78722c80bf2dcbc415a89a8ada6c6_triangle};
int form_integral_ids_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[1] = {-1};


static const char* constant_names_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[1] = {"kappa"};
static const int constant_ranks_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[1] = {0};
static const int* constant_shapes_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd[1] = {NULL,
};

ufcx_form form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd =
{

  .signature = "36b5a069145ffc8a046384134712360ac086a2009f516191fa5eacfa63bb4130cf91433679b0427cb46054d5897bd4b9a0cb73dc7f4a78379d970fbfaf373d5f",
  .rank = 2,

  .num_coefficients = 0,
  .original_coefficient_positions = NULL,
  .coefficient_name_map = NULL,

  .num_constants = 1,
  .constant_ranks = constant_ranks_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd,
  .constant_shapes = constant_shapes_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd,
  .constant_name_map = constant_names_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd,

  .finite_element_hashes = finite_element_hashes_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd,

  .form_integrals = form_integrals_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd,
  .form_integral_ids = form_integral_ids_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd,
  .form_integral_offsets = form_integral_offsets_form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd
};

// Alias name
ufcx_form* form_poisson_a = &form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd;

// End of code for form form_f880eab85ea2ceb4c4faa0d4f48be8a824cc16dd

// Code for form form_5a1002302aae555a36ab2422feba129c82156a13

int original_coefficient_position_form_5a1002302aae555a36ab2422feba129c82156a13[2] = {0, 1};
uint64_t finite_element_hashes_form_5a1002302aae555a36ab2422feba129c82156a13[3] = {UINT64_C(16933917890882727400), UINT64_C(16933917890882727400), UINT64_C(16933917890882727400)};
int form_integral_offsets_form_5a1002302aae555a36ab2422feba129c82156a13[6] = {0, 1, 2, 2, 2, 2};
static ufcx_integral* form_integrals_form_5a1002302aae555a36ab2422feba129c82156a13[2] = {&integral_67c7b0a38cf24fb7ef112ed5836c3bf9d605cc6d_triangle, &integral_28e05512f71e9adaab994a9addc20b831e88d426_interval};
int form_integral_ids_form_5a1002302aae555a36ab2422feba129c82156a13[2] = {-1, -1};

static const char* coefficient_names_form_5a1002302aae555a36ab2422feba129c82156a13[2] = {"f", "g"};




ufcx_form form_5a1002302aae555a36ab2422feba129c82156a13 =
{

  .signature = "c38f2bf8504a5647896a899206f377892457d44b65f6fa41f6afec94a0282c33f9e821eecc1b44491950fc59420c9f5ebf9fced24a6b3d15324bd68069b09883",
  .rank = 1,

  .num_coefficients = 2,
  .original_coefficient_positions = original_coefficient_position_form_5a1002302aae555a36ab2422feba129c82156a13,
  .coefficient_name_map = coefficient_names_form_5a1002302aae555a36ab2422feba129c82156a13,

  .num_constants = 0,
  .constant_ranks = NULL,
  .constant_shapes = NULL,
  .constant_name_map = NULL,

  .finite_element_hashes = finite_element_hashes_form_5a1002302aae555a36ab2422feba129c82156a13,

  .form_integrals = form_integrals_form_5a1002302aae555a36ab2422feba129c82156a13,
  .form_integral_ids = form_integral_ids_form_5a1002302aae555a36ab2422feba129c82156a13,
  .form_integral_offsets = form_integral_offsets_form_5a1002302aae555a36ab2422feba129c82156a13
};

// Alias name
ufcx_form* form_poisson_L = &form_5a1002302aae555a36ab2422feba129c82156a13;

// End of code for form form_5a1002302aae555a36ab2422feba129c82156a13
